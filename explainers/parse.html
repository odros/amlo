<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Marco Schildt, Santiago Sordo, Gülce Sena Tuncer" />


<title>Parser walkthrough</title>

<script src="walkthrough_files/header-attrs-2.11/header-attrs.js"></script>
<script src="walkthrough_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="walkthrough_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="walkthrough_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="walkthrough_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="walkthrough_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="walkthrough_files/navigation-1.1/tabsets.js"></script>
<script src="walkthrough_files/navigation-1.1/codefolding.js"></script>
<link href="walkthrough_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="walkthrough_files/highlightjs-9.12.0/highlight.js"></script>
<link href="walkthrough_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="walkthrough_files/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="custom.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Parser walkthrough</h1>
<h3 class="subtitle">A function to parse press conference transcrips</h3>
<h4 class="author">Marco Schildt, Santiago Sordo, Gülce Sena Tuncer</h4>

</div>


<p>With the transcripts scraped, the raw materials of any analysis of AMLO’s press conferences have been obtained. However, the text files are still far from being analysable. The parser will produce a data frame containing every speakers turn and speech.</p>
<div id="the-transcripts" class="section level1">
<h1>The transcripts</h1>
<p>The conference transcripts are made up of the following components * A header: this chunk’s format is almost always present and has many variations. Sometimes it includes date and location, sometimes there is a narrator style * The “speech”: the actual remarks by each of the conference’s participants. This is always in the same “SPEAKER: speech” format, meaning the speaker is always reported in all caps followed by a colon. This is is crucial, as it is -fortunately- particular enough to allow for unequivocal parsing. Most government officials are identified by name and position. Other participants get generic labels, which, unfortunately makes more granular parsing difficult. * A footer: after the last speaker has spoken, typically AMLO himself, a section with an end-of-transcript character and copyright information follows and closes the document.</p>
<p>While the header and footer could be considered useful, the parser will focus on the speech components. The plan is to extract the components and collect them in a data frame with three columns: turn, speaker and speech. This will allow any researcher to perform a diverse host of analyses.</p>
</div>
<div id="the-code" class="section level1">
<h1>The code</h1>
<p>While the repo contains a function version of the parser, this walk through will treat it as a script in order to do a step by step explanation of its contents.</p>
<p>First we read the transcript we want to parse, we’ll use the one corresponding to March 9, 2020 as an example; the file is <a href = "https://github.com/odros/amlo/blob/main/files/sample_transcript.txt">here</a> in the repo. In order to read the text file into a single string, we do the following:</p>
<pre class="r"><code># For ease, this solution uses the &#39;stringr&#39; package
library(stringr)
# Read all characters in the file and save
file &lt;- &quot;speeches/2020-03-09 no. 272.txt&quot;
document &lt;- readChar(file, file.info(file)$size)
# Read a sample to discuss
sample &lt;- readChar(file, 1000)
sample</code></pre>
<pre><code>## [1] &quot;2020, Año de Leona Vicario, Benemérita Madre de la Patria\nPRESIDENTE ANDRÉS MANUEL LÓPEZ OBRADOR: Buenos días.\nBueno, vamos a iniciar la semana informando sobre Quién es Quién en los Precios, como siempre lo hacemos; también Ricardo Rodríguez Vargas, director del Instituto para Devolver al Pueblo lo Robado, va a informar sobre la subasta de ayer en Los Pinos; vamos a informar sobre el avance de las obras, lo que siempre hacemos los lunes, cómo vamos en la construcción del aeropuerto de Santa Lucía y cómo vamos en la construcción de la refinería; y al final voy a expresar mi punto de vista, mi opinión sobre la manifestación de las mujeres ayer, del movimiento del Día Internacional de la Mujer, al final vamos a hablar sobre ese tema; y luego abrimos para preguntas y respuestas.\nEntonces, empezamos con Ricardo, bueno, los dos.\nRICARDO SHEFFIELD PADILLA, TITULAR DE LA PROCURADURÍA FEDERAL DEL CONSUMIDOR (PROFECO): Buenos días, ahora estamos los dos tocayos. Buenos días a todas y a todos us&quot;</code></pre>
<p>As you can see from the sample, the first speaker is the president and then it’s some government official’s turn. Both speakers are specified using the aforementioned “SPEAKER:” format. The most challenging aspect of the parser was coming up with a regular expression that was able to identify these speaker tags. While this may seem relatively straightforward, the present of special characters, commas and spaces required a long trial and error process to arrive at an expression that worked in all the cases we encountered. In the end we were able to achieve the capture by using the following regular expression:</p>
<pre class="r"><code>pattern &lt;- regex(&quot;([A-ZÀ-Ú][ ,\\-A-ZÀ-Ú][ ,(A-ZÀ-Ú)]+): *&quot;)
head(str_extract_all(document, pattern)[[1]], 10)</code></pre>
<pre><code>##  [1] &quot;PRESIDENTE ANDRÉS MANUEL LÓPEZ OBRADOR: &quot;                                                      
##  [2] &quot;RICARDO SHEFFIELD PADILLA, TITULAR DE LA PROCURADURÍA FEDERAL DEL CONSUMIDOR (PROFECO): &quot;      
##  [3] &quot;RICARDO RODRÍGUEZ VARGAS, DIRECTOR DEL INSTITUTO PARA DEVOLVERLE AL PUEBLO LO ROBADO (INDEP): &quot;
##  [4] &quot;PRESIDENTE ANDRÉS MANUEL LÓPEZ OBRADOR: &quot;                                                      
##  [5] &quot;VOZ MUJER: &quot;                                                                                   
##  [6] &quot;VOZ MUJER: &quot;                                                                                   
##  [7] &quot;ROCÍO NAHLE GARCÍA, SECRETARIA DE ENERGÍA: &quot;                                                   
##  [8] &quot;PRESIDENTE ANDRÉS MANUEL LÓPEZ OBRADOR: &quot;                                                      
##  [9] &quot;PREGUNTA: &quot;                                                                                    
## [10] &quot;PRESIDENTE ANDRÉS MANUEL LÓPEZ OBRADOR: &quot;</code></pre>
<p>As you can see, we have successfully -albeit with some noise- extracted the desired speaker tags. Surely, this expression is not the simplest one that can capture what we need, but we will keep it as is since it works. A lesson learned here is that regular expressions are a world in themselves.</p>
<p>The next step will be to break the speech component into its speaker and speeches. Note that here “speech” means what was spoken by each speaker in their respective turn. The strategy will be to pad each speaker tag with special delimiter characters that we can later use to break the strings down. We initially chose characters that would not occur in the transcripts: ‘#’ and ‘&amp;’. As it turned out, sometimes ‘#’ does appear as part of a speech itself, so we used repetitions of these characters:</p>
<pre class="r"><code># Prep the document by adding separator characters between the relevant parts: speaker and speech
prepped_document &lt;- str_replace_all(document, pattern, &quot;##\\1&amp;&amp;&quot;)
substr(prepped_document, 1, 200)</code></pre>
<pre><code>## [1] &quot;2020, Año de Leona Vicario, Benemérita Madre de la Patria\n##PRESIDENTE ANDRÉS MANUEL LÓPEZ OBRADOR&amp;&amp;Buenos días.\nBueno, vamos a iniciar la semana informando sobre Quién es Quién en los Precios, como s&quot;</code></pre>
<p>As you can see, the speaker tags are now padded. From here, we first need to extract every turn -every instance of a speaker speaking- by splitting the parsed document used our left padding character “#”. We will only be showing the first speaker’s turn because their remarks are quite long:</p>
<pre class="r"><code># Parse each turn by splitting the speech into speaker-speech elements 
parsed_turns &lt;- unlist(str_split(prepped_document, &quot;##&quot;))

# Leave non-speech elements outside (line 1)
parsed_turns &lt;- parsed_turns[2:length(parsed_turns)]
parsed_turns[1]</code></pre>
<pre><code>## [1] &quot;PRESIDENTE ANDRÉS MANUEL LÓPEZ OBRADOR&amp;&amp;Buenos días.\nBueno, vamos a iniciar la semana informando sobre Quién es Quién en los Precios, como siempre lo hacemos; también Ricardo Rodríguez Vargas, director del Instituto para Devolver al Pueblo lo Robado, va a informar sobre la subasta de ayer en Los Pinos; vamos a informar sobre el avance de las obras, lo que siempre hacemos los lunes, cómo vamos en la construcción del aeropuerto de Santa Lucía y cómo vamos en la construcción de la refinería; y al final voy a expresar mi punto de vista, mi opinión sobre la manifestación de las mujeres ayer, del movimiento del Día Internacional de la Mujer, al final vamos a hablar sobre ese tema; y luego abrimos para preguntas y respuestas.\nEntonces, empezamos con Ricardo, bueno, los dos.\n&quot;</code></pre>
<p>As you can see, the first element of the parsed turns corresponds to the first speaker-speech pair and the “&amp;&amp;” delimiter is there between both components. We have skipped the first line, as it corresponds to the transcripts header. We now just have to split each turn into speaker and speech using this delimiter. To do this, we will store each turn into a data frame:</p>
<pre class="r"><code>turns &lt;- data.frame(matrix(NA, nrow = length(parsed_turns), ncol = 3))
colnames(turns) &lt;- c(&quot;turn&quot;, &quot;speaker&quot;, &quot;speech&quot;)

# Populate the data frame with the turns: separated and white space-trimmed speaker and speech
for(i in 1:length(parsed_turns))
{
  turns$turn[i] &lt;- i
  turns$speaker[i] &lt;- str_trim(unlist(str_split(parsed_turns[i], &quot;&amp;&amp;&quot;))[1], side = &quot;both&quot;)
  turns$speech[i] &lt;- str_trim(unlist(str_split(parsed_turns[i], &quot;&amp;&amp;&quot;))[2], side = &quot;both&quot;)
}
head(turns, 3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["turn"],"name":[1],"type":["int"],"align":["right"]},{"label":["speaker"],"name":[2],"type":["chr"],"align":["left"]},{"label":["speech"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"PRESIDENTE ANDRÉS MANUEL LÓPEZ OBRADOR","3":"Buenos días.\\nBueno, vamos a iniciar la semana informando sobre Quién es Quién en los Precios, como siempre lo hacemos; también Ricardo Rodríguez Vargas, director del Instituto para Devolver al Pueblo lo Robado, va a informar sobre la subasta de ayer en Los Pinos; vamos a informar sobre el avance de las obras, lo que siempre hacemos los lunes, cómo vamos en la construcción del aeropuerto de Santa Lucía y cómo vamos en la construcción de la refinería; y al final voy a expresar mi punto de vista, mi opinión sobre la manifestación de las mujeres ayer, del movimiento del Día Internacional de la Mujer, al final vamos a hablar sobre ese tema; y luego abrimos para preguntas y respuestas.\\nEntonces, empezamos con Ricardo, bueno, los dos.","_rn_":"1"},{"1":"2","2":"RICARDO SHEFFIELD PADILLA, TITULAR DE LA PROCURADURÍA FEDERAL DEL CONSUMIDOR (PROFECO)","3":"Buenos días, ahora estamos los dos tocayos. Buenos días a todas y a todos ustedes. Gracias, señor presidente.\\nQuién es quién en los precios de los combustibles. En la gasolina regular, el precio más alto, con el margen más alto, lo encontramos en la estación de servicio Ersal, en Hermosillo, Sonora, 21 pesos con 40 centavos por litro, con un margen de tres pesos 82 centavos, un margen bastante amplio; Estaciones de Servicio en Tuxtla Gutiérrez, Chiapas, tiene el precio más bajo, 18.24 por litro, con un margen de 34 centavos.\\nLa gasolina Premium en Mexal, Atizapán de Zaragoza, en el Estado de México, a 22 pesos con 94 centavos por litros y un margen de cuatro pesos 59 centavos es el más alto para Premium en el país, con el margen más alto; mientras que Servicio Boca, en Veracruz, Veracruz, con un precio al público de 17 pesos 44 centavos y un margen de 65 centavos son el más bajo para Premium.\\nEn el diésel, Gasolinera del Valle, en Zamora, Michoacán, con un precio de 22 pesos 36 centavos por litro y un margen de tres pesos 79 centavos es el más caro; y el más barato Servicios de Combustibles Lázaro Cárdenas, en Lázaro Cárdenas, Michoacán, un precio al público de 19 pesos por litro con un margen de 96 centavos.\\nSi lo vemos por marca, las más baratas es Gulf, LaGas y Orsan; y las más caras Chevron, Arco y Redco. Eso es por marcas, igual que la semana pasada, ahí no hubo variación.\\nEn acciones de verificación, realizamos 169 visitas y verificaciones, atendiendo a 230 llamadas o reportes recibidos a través de la app de Litro por Litro, fueron ocho bombas inmovilizadas que no daban litros de litro, bajó en esta semana, qué bueno que se están portando bien los gasolineros.\\nY tuvimos un caso donde no ser permitió la colocación de sellos, además del haber descubierto ahí anomalías y tendremos que regresar con fuerza pública. Esta es una gasolinera que se llama Almacenes Distribuidores de la Frontera, en Ciudad Juárez, Chihuahua, en Boulevard Gómez Morín, 9470, para que tomen nota todos los que viven en esta ciudad en la frontera.\\nLo que nos llamó la atención de este caso es que tanto el abogado, que llevó el asunto y que nos impidió poner los sellos, como todos los empleados de la gasolinera nos decían que si no sabíamos quién era la dueña de esa gasolinera; y nos informaron que era Alejandra de la Vega, efectivamente lo es, quien es la secretaria de Innovación y Desarrollo Económico del gobierno del estado de Chihuahua.\\nEs el primer caso de prepotencia, de que: ‘No saben quién soy yo’, que se nos presenta en lo que lleva esta administración. Lamentable, pero volveremos a la colocación de los sellos con el apoyo de la Guardia Nacional y ojalá esta funcionaria pública ponga el ejemplo de obedecer y cumplir con la ley.\\nEn la app tenemos la gasolina más barata, 17 pesos 45 centavos en Centro, Tabasco; mientras que la más cara 21.99 en Talpa de Allende, Jalisco, esto es sin tomar en cuenta el margen, sólo el precio al público.\\nPremium, 17.58 en Veracruz, Veracruz; 23 39 en Benito Juárez, la más cara aquí en la Ciudad de México.\\nDiésel, 18 pesos con 29 centavos la más económica, en Medellín de Bravo, Veracruz; mientras que la más cara está en Sinaloa, Sinaloa, a 22 pesos con 70 centavos.\\nSeguimos monitoreando otros servicios que son de interés para los consumidores. Quién es quién en el gas LP para tanques estacionarios, el precio más caro lo encontramos con el margen más alto en Holbox, a 11 pesos 49 centavos por litro, cuatro pesos 45 centavos de margen, no se manden estos señores en Holbox, Gas, S.A. de C.V., porque de por sí es una zona complicada de llegar y es lamentable que abusen de estas condiciones para dar más caro el gas.\\nEl tanque estacionario lo da, el más barato por litro, 7.25 en Victoria, Tamaulipas Combustibles de Victoria, con un margen de un peso 87 centavos.\\nPara cilindros de gas, en Holbox, otra vez abusando de esta situación, está Holbox S.A. de C.V., en Chetumal, Quintana Roo 21.28 en la capital del estado con un precio al público por kilo y 7.54 el margen por kilo; mientras que en Gas Menguc en Pátzcuaro, Michoacán tenemos el más barato para cilindros de gas a 14 pesos cuatro centavos por kilo con un margen de 2.95 por kilo.\\nVerificaciones de gas LP realizamos en esta semana 44 verificaciones, resultaron ocho con infracción, afortunadamente todos se dejaron verificar, una de 196 básculas inmovilizadas, bastante bajo, cuatro vehículos inmovilizados de 17 a 24 por ciento, alto en esta semana para vehículos inmovilizados.\\nAutotanques tres de 48 y encontramos un 2 por ciento de cilindros que ponían en riesgo a los consumidores.\\nY esta semana toca como una vez al mes la presentación de quién es quién en el envío del dinero de los Estados Unidos, as remesas de nuestras paisanas y paisanos.\\nPara envíos en efectivo, el precio más alto de comisión y el tipo de cambio más bajo, que son las dos variables que tomamos en cuenta sobre un envío de 300 dólares, descubrimos con ello que conviene más enviar dinero en efectivo de los Estados Unidos por medio de Ria Money Transfer, que tiene una comisión de cinco dólares en promedio, con un tipo de cambio promedio en el último mes de 19 pesos 57 centavos, por lo tanto, la señora recibe acá en México cinco mil 773.15 centavos; mientras que el peor para envío de efectivos de Estados Unidos a México es Western Union, que se ha mantenido así como el peor ya en varias ocasiones, porque cobra una comisión de ocho dólares con un tipo de cambio promedio de 19 dólares con 15 centavos y al final la mamá o la esposa aquí en México recibe cinco mil 592 pesos con 45 centavos. Como ven ustedes, es significativa la diferencia.\\nPero si vas a hacer depósito en cuenta, que no es efectivo, la mejor operación la puedes realizar con Ulink, que no tiene comisión, con un tipo de cambio de 19.80, se ve bastante mejor el tipo de cambio y al final la señora recibe cinco mil 940 pesos; mientras que la peor opción la encontramos en Golden Money Transfer, que de golden no tiene nada, cinco mil 575 pesos es lo que al final reciben, ellos sí cobran una golden comisión de cuatro dólares con 99 centavos, un tipo de cambio de 18.90, muy bajo, y por eso ese resultado.\\nSi lo vemos por las receptoras de este lado, en México, quien tiene más presencia en municipios, Banco del Bienestar con dos mil 232 municipios atendidos, y luego le sigue Telecomm con mil 221.\\nEl mejor horario lo tiene Oxxo, que abre de las 6:00 de la mañana a las 10:00 de la noche y además Oxxo es el que tiene más sucursales en todo el país, 19 mil 146 sucursales en mil 40 municipios.\\nY, por último, si nosotros nos fijamos en otras de las variables tenemos que el seguro contra robo solamente lo ofrece Elektra, Walmart y Caja Popular Mexicana. Todos hacen la verificación del receptor y solamente Inbursa solicita forzosamente que tengan una cuenta con ellos, los demás no lo solicitan y nos falta todavía que Farmacias Guadalajara e Inbursa nos reporten cuántos municipios son los que cubren ellos con su servicio.\\nEs cuanto. Muchas gracias.","_rn_":"2"},{"1":"3","2":"RICARDO RODRÍGUEZ VARGAS, DIRECTOR DEL INSTITUTO PARA DEVOLVERLE AL PUEBLO LO ROBADO (INDEP)","3":"Muchas gracias, señor presidente. Buenos días a todas y a todos.\\nVamos a dar a conocer los resultados de la primera subasta 2020 con sentido social. Como habíamos comentado, arrancamos el año con el objetivo de consolidar este tipo de instrumentos de política social que el señor presidente nos ha instruido de comprar un bien para hacer el bien.\\nEl día de ayer comenzamos a cumplir con este propósito de llevar los resultados del instituto al siguiente nivel. Podemos decir de forma muy grata que el resultado de la subasta fue un éxito.\\n¿Por qué fue un éxito?\\nPorque logramos la mayor participación en la historia de las subastas que hemos realizado en Los Pinos, ayer registramos la mejor asistencia en la subasta. La gente no dejó de bajar las paletas, estuvo constantemente con paletas arriba, vendimos alrededor de 70 por ciento de los bienes y fue un gran entusiasmo, una gran solidaridad de las personas que incluso todavía antes de las 11:00 estuvieron registrando o haciendo filas en el Centro Cultural Los Pinos para poder participar.\\nAhí viene el desglose de lo que ayer vendimos y al sobreprecio que vendimos. En bienes inmuebles vendimos dos:\\nUna casa en Cancún, que ahorita les muestro las fotos, en alrededor de 15 millones 400 mil pesos; otra casa de cuatro millones en Tlajomulco, Jalisco.\\nEn los vehículos de lujo presentamos un sobreprecio del 150 por ciento, ahí también ahorita les muestro las fotos y los precios a los cuales vendimos, sobre todo los Mercedes y los BMW.\\nEn joyas, usualmente la anterior subasta se nos dificultó un poco. En esta ocasión no, la gente tuvo una mayor… fue bien recibido, las joyas, sobre todo de menor valor, las compraron y en general fue un sobreprecio de 27 por ciento.\\nAlgo para nosotros que nos llamó la atención, vendimos algunas aeronaves tipo chatarra.\\n¿Qué quiero decir con chatarra?\\nQue se están desmanteladas, que estaba en sus almacenes y tuvimos un sobreprecio de más de dos mil 500 por ciento. Estas aeronaves chatarras pueden servir para escuelas de aviación, para partes, en fin, nos llevó la grata sorpresa que fueron bien recibidos.\\n¿Cuál fue el monto que se recaudó en la subasta?\\nFueron 53 millones 414 500 pesos, fue un sobreprecio del 56 por ciento en general en la subasta. Insisto, casi fue 54 millones lo que se recaudó ayer de esta subasta con sentido social.\\nVamos a ver algunos ejemplos. Esta casa está ubicada en Cancún, empezó en 14 millones 700 mil, subió la puja ligeramente en cinco por ciento y fue una puja telefónica, hay gente que estaba ahí presente y al final se llegó a 15 millones 14 mil pesos.\\nLa siguiente es una casa que se vendió en cuatro millones en Tlajomulco, Jalisco, esa también uno de los postores que originalmente no iba por las casas pero que le gustó en ese momento, decidió adquirirla.\\nEstos vehículos, los dos que voy a mostrar son Mercedes Benz. Para que ustedes tengan una idea, empezó la puja en 767 mil pesos, ese fue el precio inicial, al final logramos un sobreprecio de alrededor de 350 por ciento en promedio.\\nEste negro se vendió en tres millones 700 mil pesos, hubo otro que se vendió, el siguiente, un blanco en tres millones 300 mil pesos. Vamos, ahí fue donde sentimos la mayor puja entre los participantes, constantemente, insisto, fue las paletas arriba, hubo una puja muy intensa y muy fuerte.\\nAhí tenemos este BMW, que se le llama ‘Alas de gaviota’ por cómo se elevan las puertas, este vehículo empezó en 653 mil pesos y se vendió en un millón, casi un millón y medio, en un millón 400 mil pesos, fue al final como se vendió este vehículo.\\nInsisto, en estos vehículos de gama alta la puja fue muy fuerte, fue muy intensa, hubo gente que quería adquirir estos vehículos, pero se cerró mucho al final y sí se lograron precios para nosotros importantes y precios que elevaron nuestra recaudación.\\nEsta es una camioneta blindada, esta camioneta blindada empezó en 762 mil y terminó en un millón 825 mil, con un sobreprecio del 140 por ciento.\\nUn vehículo Corvette, este vehículo Corvette empezó en 353 mil, se vendió en casi un millón de pesos a un sobreprecio de 163 por ciento.\\nTambién, fíjense que algo que se vendió muy bien fueron estos relojes Rolex de gama alta, estos con incrustaciones de diamantes. Estos relojes Rolex en promedio andaban 140 mil, 150 mil, aquí pueden ver este que tiene incrustaciones de diamantes, este se vendió al doble y se vendió, del precio inicial me refiero, y se vendió en 280 mil pesos.\\nY así vendimos también la mayoría de la joyería que ahora sí tuvo un buen recibimiento, se pudo vender bien, fluyó bien la joyería.\\nAl final tenemos una aeronave… esto es parte también de la joyería. Tenemos esta aeronave, que es lo que les comentaba, una aeronave tipo chatarra, porque ya está desmantelada, está en nuestros almacenes. Antes no se podían vender, ahora con la reforma a la ley del Indep, que ya también podemos vender bienes asegurados, ya pudimos sacamos cerca de un millón de pesos por esto que ya lleva siete, ocho años ahí en el almacén y que ya nos permite monetizar este tipo de activos.\\n¿Para dónde van los recursos?\\nEn este caso los recursos van a ir para el Fondo de Cultura Económica. Vamos a fondear, por instrucciones muy puntuales del señor presidente, para fomento de la lectura, para fomento de la cultura, son más de dos millones de libros, dos millones 100 mil que son obras muy interesantes, muy bonitas, muy amenas y es un placer para la lectura este tipo de 21 obras, que se van a financiar su costo editorial para el Fondo de Cultura Económica y son más de dos millones de libros.\\nFinalmente, agradecerle a la ciudadanía que nos acompañó ayer, que prácticamente se desbordó al Centro Cultural Los Pinos y que nos hizo obtener un muy buen resultado, un éxito de la subasta y su solidaridad, su apoyo y sobre todo el sumarse a estas causas nobles al proyecto del señor presidente de destinar los recursos para fines sociales y comprar un bien para hacer el bien.\\nMuchas gracias y cualquier cosa estoy a sus órdenes.","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>As you can see, we have arrived at the desired table with a turn, speaker and speech structure. We have done some white space removal in the loop to take advantage of the iteration. Now all is left to do is removing the footer and some formatting:</p>
<pre class="r"><code>turns$speech[length(parsed_turns)]</code></pre>
<pre><code>## [1] &quot;Sí, están afectadas las bolsas del mundo y estamos esperando que haya normalidad, que haya tranquilidad, que tengamos estabilidad económica y financiera.\nMañana hablamos más. Muchas gracias.\n+++++\n© Copyright Derechos Reservados 2011-2020 - Sitio Oficial de Andrés Manuel López Obrador.&quot;</code></pre>
<p>The last turn includes the footer, which we should remove. To achieve this and format the speaker tags, we do the following:</p>
<pre class="r"><code># Remove non-speech components (those after the &quot;[+++++]&quot; string or &quot;©&quot; symbol)
if(grepl(&quot;[+++++]&quot;, turns$speech[length(parsed_turns)]) == TRUE)
{
  turns$speech[length(parsed_turns)] &lt;- unlist(str_split(turns$speech[length(parsed_turns)], &quot;[+++++]&quot;))[1]
} else
{
  turns$speech[length(parsed_turns)] &lt;- unlist(str_split(turns$speech[length(parsed_turns)], &quot;©&quot;))[1]
}
# This is almost consistent, as sometimes other strings (like &quot;[– – – 0- – –]&quot;) are used

# Convert all speakers to title case
turns$speaker &lt;- str_to_title(turns$speaker, locale = &quot;es&quot;)
# Some words should not be capitalized. May fix this to make more aesthetically appealing.
turns$speech[length(parsed_turns)]</code></pre>
<pre><code>## [1] &quot;Sí, están afectadas las bolsas del mundo y estamos esperando que haya normalidad, que haya tranquilidad, que tengamos estabilidad económica y financiera.\nMañana hablamos más. Muchas gracias.\n&quot;</code></pre>
<pre class="r"><code>head(turns, 3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["turn"],"name":[1],"type":["int"],"align":["right"]},{"label":["speaker"],"name":[2],"type":["chr"],"align":["left"]},{"label":["speech"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"Presidente Andrés Manuel López Obrador","3":"Buenos días.\\nBueno, vamos a iniciar la semana informando sobre Quién es Quién en los Precios, como siempre lo hacemos; también Ricardo Rodríguez Vargas, director del Instituto para Devolver al Pueblo lo Robado, va a informar sobre la subasta de ayer en Los Pinos; vamos a informar sobre el avance de las obras, lo que siempre hacemos los lunes, cómo vamos en la construcción del aeropuerto de Santa Lucía y cómo vamos en la construcción de la refinería; y al final voy a expresar mi punto de vista, mi opinión sobre la manifestación de las mujeres ayer, del movimiento del Día Internacional de la Mujer, al final vamos a hablar sobre ese tema; y luego abrimos para preguntas y respuestas.\\nEntonces, empezamos con Ricardo, bueno, los dos.","_rn_":"1"},{"1":"2","2":"Ricardo Sheffield Padilla, Titular De La Procuraduría Federal Del Consumidor (Profeco)","3":"Buenos días, ahora estamos los dos tocayos. Buenos días a todas y a todos ustedes. Gracias, señor presidente.\\nQuién es quién en los precios de los combustibles. En la gasolina regular, el precio más alto, con el margen más alto, lo encontramos en la estación de servicio Ersal, en Hermosillo, Sonora, 21 pesos con 40 centavos por litro, con un margen de tres pesos 82 centavos, un margen bastante amplio; Estaciones de Servicio en Tuxtla Gutiérrez, Chiapas, tiene el precio más bajo, 18.24 por litro, con un margen de 34 centavos.\\nLa gasolina Premium en Mexal, Atizapán de Zaragoza, en el Estado de México, a 22 pesos con 94 centavos por litros y un margen de cuatro pesos 59 centavos es el más alto para Premium en el país, con el margen más alto; mientras que Servicio Boca, en Veracruz, Veracruz, con un precio al público de 17 pesos 44 centavos y un margen de 65 centavos son el más bajo para Premium.\\nEn el diésel, Gasolinera del Valle, en Zamora, Michoacán, con un precio de 22 pesos 36 centavos por litro y un margen de tres pesos 79 centavos es el más caro; y el más barato Servicios de Combustibles Lázaro Cárdenas, en Lázaro Cárdenas, Michoacán, un precio al público de 19 pesos por litro con un margen de 96 centavos.\\nSi lo vemos por marca, las más baratas es Gulf, LaGas y Orsan; y las más caras Chevron, Arco y Redco. Eso es por marcas, igual que la semana pasada, ahí no hubo variación.\\nEn acciones de verificación, realizamos 169 visitas y verificaciones, atendiendo a 230 llamadas o reportes recibidos a través de la app de Litro por Litro, fueron ocho bombas inmovilizadas que no daban litros de litro, bajó en esta semana, qué bueno que se están portando bien los gasolineros.\\nY tuvimos un caso donde no ser permitió la colocación de sellos, además del haber descubierto ahí anomalías y tendremos que regresar con fuerza pública. Esta es una gasolinera que se llama Almacenes Distribuidores de la Frontera, en Ciudad Juárez, Chihuahua, en Boulevard Gómez Morín, 9470, para que tomen nota todos los que viven en esta ciudad en la frontera.\\nLo que nos llamó la atención de este caso es que tanto el abogado, que llevó el asunto y que nos impidió poner los sellos, como todos los empleados de la gasolinera nos decían que si no sabíamos quién era la dueña de esa gasolinera; y nos informaron que era Alejandra de la Vega, efectivamente lo es, quien es la secretaria de Innovación y Desarrollo Económico del gobierno del estado de Chihuahua.\\nEs el primer caso de prepotencia, de que: ‘No saben quién soy yo’, que se nos presenta en lo que lleva esta administración. Lamentable, pero volveremos a la colocación de los sellos con el apoyo de la Guardia Nacional y ojalá esta funcionaria pública ponga el ejemplo de obedecer y cumplir con la ley.\\nEn la app tenemos la gasolina más barata, 17 pesos 45 centavos en Centro, Tabasco; mientras que la más cara 21.99 en Talpa de Allende, Jalisco, esto es sin tomar en cuenta el margen, sólo el precio al público.\\nPremium, 17.58 en Veracruz, Veracruz; 23 39 en Benito Juárez, la más cara aquí en la Ciudad de México.\\nDiésel, 18 pesos con 29 centavos la más económica, en Medellín de Bravo, Veracruz; mientras que la más cara está en Sinaloa, Sinaloa, a 22 pesos con 70 centavos.\\nSeguimos monitoreando otros servicios que son de interés para los consumidores. Quién es quién en el gas LP para tanques estacionarios, el precio más caro lo encontramos con el margen más alto en Holbox, a 11 pesos 49 centavos por litro, cuatro pesos 45 centavos de margen, no se manden estos señores en Holbox, Gas, S.A. de C.V., porque de por sí es una zona complicada de llegar y es lamentable que abusen de estas condiciones para dar más caro el gas.\\nEl tanque estacionario lo da, el más barato por litro, 7.25 en Victoria, Tamaulipas Combustibles de Victoria, con un margen de un peso 87 centavos.\\nPara cilindros de gas, en Holbox, otra vez abusando de esta situación, está Holbox S.A. de C.V., en Chetumal, Quintana Roo 21.28 en la capital del estado con un precio al público por kilo y 7.54 el margen por kilo; mientras que en Gas Menguc en Pátzcuaro, Michoacán tenemos el más barato para cilindros de gas a 14 pesos cuatro centavos por kilo con un margen de 2.95 por kilo.\\nVerificaciones de gas LP realizamos en esta semana 44 verificaciones, resultaron ocho con infracción, afortunadamente todos se dejaron verificar, una de 196 básculas inmovilizadas, bastante bajo, cuatro vehículos inmovilizados de 17 a 24 por ciento, alto en esta semana para vehículos inmovilizados.\\nAutotanques tres de 48 y encontramos un 2 por ciento de cilindros que ponían en riesgo a los consumidores.\\nY esta semana toca como una vez al mes la presentación de quién es quién en el envío del dinero de los Estados Unidos, as remesas de nuestras paisanas y paisanos.\\nPara envíos en efectivo, el precio más alto de comisión y el tipo de cambio más bajo, que son las dos variables que tomamos en cuenta sobre un envío de 300 dólares, descubrimos con ello que conviene más enviar dinero en efectivo de los Estados Unidos por medio de Ria Money Transfer, que tiene una comisión de cinco dólares en promedio, con un tipo de cambio promedio en el último mes de 19 pesos 57 centavos, por lo tanto, la señora recibe acá en México cinco mil 773.15 centavos; mientras que el peor para envío de efectivos de Estados Unidos a México es Western Union, que se ha mantenido así como el peor ya en varias ocasiones, porque cobra una comisión de ocho dólares con un tipo de cambio promedio de 19 dólares con 15 centavos y al final la mamá o la esposa aquí en México recibe cinco mil 592 pesos con 45 centavos. Como ven ustedes, es significativa la diferencia.\\nPero si vas a hacer depósito en cuenta, que no es efectivo, la mejor operación la puedes realizar con Ulink, que no tiene comisión, con un tipo de cambio de 19.80, se ve bastante mejor el tipo de cambio y al final la señora recibe cinco mil 940 pesos; mientras que la peor opción la encontramos en Golden Money Transfer, que de golden no tiene nada, cinco mil 575 pesos es lo que al final reciben, ellos sí cobran una golden comisión de cuatro dólares con 99 centavos, un tipo de cambio de 18.90, muy bajo, y por eso ese resultado.\\nSi lo vemos por las receptoras de este lado, en México, quien tiene más presencia en municipios, Banco del Bienestar con dos mil 232 municipios atendidos, y luego le sigue Telecomm con mil 221.\\nEl mejor horario lo tiene Oxxo, que abre de las 6:00 de la mañana a las 10:00 de la noche y además Oxxo es el que tiene más sucursales en todo el país, 19 mil 146 sucursales en mil 40 municipios.\\nY, por último, si nosotros nos fijamos en otras de las variables tenemos que el seguro contra robo solamente lo ofrece Elektra, Walmart y Caja Popular Mexicana. Todos hacen la verificación del receptor y solamente Inbursa solicita forzosamente que tengan una cuenta con ellos, los demás no lo solicitan y nos falta todavía que Farmacias Guadalajara e Inbursa nos reporten cuántos municipios son los que cubren ellos con su servicio.\\nEs cuanto. Muchas gracias.","_rn_":"2"},{"1":"3","2":"Ricardo Rodríguez Vargas, Director Del Instituto Para Devolverle Al Pueblo Lo Robado (Indep)","3":"Muchas gracias, señor presidente. Buenos días a todas y a todos.\\nVamos a dar a conocer los resultados de la primera subasta 2020 con sentido social. Como habíamos comentado, arrancamos el año con el objetivo de consolidar este tipo de instrumentos de política social que el señor presidente nos ha instruido de comprar un bien para hacer el bien.\\nEl día de ayer comenzamos a cumplir con este propósito de llevar los resultados del instituto al siguiente nivel. Podemos decir de forma muy grata que el resultado de la subasta fue un éxito.\\n¿Por qué fue un éxito?\\nPorque logramos la mayor participación en la historia de las subastas que hemos realizado en Los Pinos, ayer registramos la mejor asistencia en la subasta. La gente no dejó de bajar las paletas, estuvo constantemente con paletas arriba, vendimos alrededor de 70 por ciento de los bienes y fue un gran entusiasmo, una gran solidaridad de las personas que incluso todavía antes de las 11:00 estuvieron registrando o haciendo filas en el Centro Cultural Los Pinos para poder participar.\\nAhí viene el desglose de lo que ayer vendimos y al sobreprecio que vendimos. En bienes inmuebles vendimos dos:\\nUna casa en Cancún, que ahorita les muestro las fotos, en alrededor de 15 millones 400 mil pesos; otra casa de cuatro millones en Tlajomulco, Jalisco.\\nEn los vehículos de lujo presentamos un sobreprecio del 150 por ciento, ahí también ahorita les muestro las fotos y los precios a los cuales vendimos, sobre todo los Mercedes y los BMW.\\nEn joyas, usualmente la anterior subasta se nos dificultó un poco. En esta ocasión no, la gente tuvo una mayor… fue bien recibido, las joyas, sobre todo de menor valor, las compraron y en general fue un sobreprecio de 27 por ciento.\\nAlgo para nosotros que nos llamó la atención, vendimos algunas aeronaves tipo chatarra.\\n¿Qué quiero decir con chatarra?\\nQue se están desmanteladas, que estaba en sus almacenes y tuvimos un sobreprecio de más de dos mil 500 por ciento. Estas aeronaves chatarras pueden servir para escuelas de aviación, para partes, en fin, nos llevó la grata sorpresa que fueron bien recibidos.\\n¿Cuál fue el monto que se recaudó en la subasta?\\nFueron 53 millones 414 500 pesos, fue un sobreprecio del 56 por ciento en general en la subasta. Insisto, casi fue 54 millones lo que se recaudó ayer de esta subasta con sentido social.\\nVamos a ver algunos ejemplos. Esta casa está ubicada en Cancún, empezó en 14 millones 700 mil, subió la puja ligeramente en cinco por ciento y fue una puja telefónica, hay gente que estaba ahí presente y al final se llegó a 15 millones 14 mil pesos.\\nLa siguiente es una casa que se vendió en cuatro millones en Tlajomulco, Jalisco, esa también uno de los postores que originalmente no iba por las casas pero que le gustó en ese momento, decidió adquirirla.\\nEstos vehículos, los dos que voy a mostrar son Mercedes Benz. Para que ustedes tengan una idea, empezó la puja en 767 mil pesos, ese fue el precio inicial, al final logramos un sobreprecio de alrededor de 350 por ciento en promedio.\\nEste negro se vendió en tres millones 700 mil pesos, hubo otro que se vendió, el siguiente, un blanco en tres millones 300 mil pesos. Vamos, ahí fue donde sentimos la mayor puja entre los participantes, constantemente, insisto, fue las paletas arriba, hubo una puja muy intensa y muy fuerte.\\nAhí tenemos este BMW, que se le llama ‘Alas de gaviota’ por cómo se elevan las puertas, este vehículo empezó en 653 mil pesos y se vendió en un millón, casi un millón y medio, en un millón 400 mil pesos, fue al final como se vendió este vehículo.\\nInsisto, en estos vehículos de gama alta la puja fue muy fuerte, fue muy intensa, hubo gente que quería adquirir estos vehículos, pero se cerró mucho al final y sí se lograron precios para nosotros importantes y precios que elevaron nuestra recaudación.\\nEsta es una camioneta blindada, esta camioneta blindada empezó en 762 mil y terminó en un millón 825 mil, con un sobreprecio del 140 por ciento.\\nUn vehículo Corvette, este vehículo Corvette empezó en 353 mil, se vendió en casi un millón de pesos a un sobreprecio de 163 por ciento.\\nTambién, fíjense que algo que se vendió muy bien fueron estos relojes Rolex de gama alta, estos con incrustaciones de diamantes. Estos relojes Rolex en promedio andaban 140 mil, 150 mil, aquí pueden ver este que tiene incrustaciones de diamantes, este se vendió al doble y se vendió, del precio inicial me refiero, y se vendió en 280 mil pesos.\\nY así vendimos también la mayoría de la joyería que ahora sí tuvo un buen recibimiento, se pudo vender bien, fluyó bien la joyería.\\nAl final tenemos una aeronave… esto es parte también de la joyería. Tenemos esta aeronave, que es lo que les comentaba, una aeronave tipo chatarra, porque ya está desmantelada, está en nuestros almacenes. Antes no se podían vender, ahora con la reforma a la ley del Indep, que ya también podemos vender bienes asegurados, ya pudimos sacamos cerca de un millón de pesos por esto que ya lleva siete, ocho años ahí en el almacén y que ya nos permite monetizar este tipo de activos.\\n¿Para dónde van los recursos?\\nEn este caso los recursos van a ir para el Fondo de Cultura Económica. Vamos a fondear, por instrucciones muy puntuales del señor presidente, para fomento de la lectura, para fomento de la cultura, son más de dos millones de libros, dos millones 100 mil que son obras muy interesantes, muy bonitas, muy amenas y es un placer para la lectura este tipo de 21 obras, que se van a financiar su costo editorial para el Fondo de Cultura Económica y son más de dos millones de libros.\\nFinalmente, agradecerle a la ciudadanía que nos acompañó ayer, que prácticamente se desbordó al Centro Cultural Los Pinos y que nos hizo obtener un muy buen resultado, un éxito de la subasta y su solidaridad, su apoyo y sobre todo el sumarse a estas causas nobles al proyecto del señor presidente de destinar los recursos para fines sociales y comprar un bien para hacer el bien.\\nMuchas gracias y cualquier cosa estoy a sus órdenes.","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>As you can see, the last turn is now without the footer and every speaker tag is formatted. The parser function takes a raw transcription in text form and converts it into a usable data frame with one row per turn! <br></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
